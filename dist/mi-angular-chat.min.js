!function(t){function e(s){if(a[s])return a[s].exports;var l=a[s]={exports:{},id:s,loaded:!1};return t[s].call(l.exports,l,l.exports,e),l.loaded=!0,l.exports}var a={};return e.m=t,e.c=a,e.p="",e(0)}([function(t,e){"use strict";t.exports=angular.module("mi.Chat",["mi/template/chat.html"]).controller("MiChatController",["$scope","$timeout",function(t,e){function a(){t.submitCallback()(l.message,l.username),l.message="",s()}function s(){e(function(){t.$msgContainer[0].scrollTop=t.$msgContainer[0].scrollHeight},200,!1)}var l=this;l.messages=t.messages,l.username=t.username,l.inputPlaceholderText=t.inputPlaceholderText,l.submitButtonText=t.submitButtonText,l.title=t.title,l.message="",l.submitCall=a,t.$watch("chat.messages",function(){s(),e(function(){t.$chatInput.focus()},200)}),t.$watch("chat.messages.length",function(){t.historyLoading||s()})}]).directive("miChat",["$timeout","lodash",function(t,e){return{restrict:"EA",replace:!0,controller:"MiChatController",controllerAs:"chat",templateUrl:function(t,e){return e.templateUrl||"mi/template/chat.html"},scope:{messages:"=",username:"=",title:"@",inputPlaceholderText:"@",submitButtonText:"@",submitCallback:"&"},link:function(a,s){a.title||(a.title="Chat"),a.inputPlaceholderText||(a.inputPlaceholderText="... your message ..."),a.submitButtonText||(a.submitButtonText="Send"),a.$msgContainer=angular.element(s[0].querySelector(".chat-body")),a.$chatInput=s[0].querySelector(".chat-input-field");var l=a.$msgContainer[0];a.$msgContainer.bind("scroll",e.throttle(function(){var e=l.scrollHeight;l.scrollTop<=10&&(a.historyLoading=!0,a.$apply(a.infiniteScroll),t(function(){a.historyLoading=!1,e!==l.scrollHeight&&(a.$msgContainer[0].scrollTop=360)},150))},300))}}}]),angular.module("mi/template/chat.html",[]).run(["$templateCache",function(t){t.put("mi/template/chat.html",'<div class="row mi-chat"><div class="col-xs-12 col-sm-12"><div class="panel panel-default"><div class="panel-heading chat-header"><h3 class="panel-title">{{chat.title}}</h3></div><div class="panel-body chat-body"><div class="row chat-message" ng-repeat="message in chat.messages" ng-class="{\'self-authored\': (chat.username == message.username)}"><div class="col-xs-12 col-sm-12"><p>{{message.content}}</p><p>{{message.username}}</p></div></div></div><div class="panel-footer chat-footer"><form ng-submit="chat.submitCall()"><div class="input-group"><input type="text" class="form-control chat-input-field" placeholder="{{chat.inputPlaceholderText}}" ng-model="chat.message"/><span class="input-group-btn"><input type="submit" class="btn btn-primary chat-submit-button" value="{{chat.submitButtonText}}"/></span></div></form></div></div></div></div>')}])}]);